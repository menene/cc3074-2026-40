print("--- Column Proportions ---")
col_proportions <- prop.table(contingency_table, margin = 2)
print(round(col_proportions * 100, 2))
print(round(row_proportions * 100, 2))
col_proportions <- prop.table(contingency_table, margin = 2)
row_proportions
churn
geography_variable <- churn$Geography
mean_by_geography <- tapply(estimated_salary_variable, geography_variable, mean)
median_by_geography <- tapply(estimated_salary_variable, geography_variable, median)
sd_by_geography <- tapply(estimated_salary_variable, geography_variable, sd)
iqr_by_geography <- tapply(estimated_salary_variable, geography_variable, IQR)
summary_by_geography <- tapply(estimated_salary_variable, geography_variable, summary)
boxplot(EstimatedSalary ~ Geography,
data = churn,
main = "Distribution of EstimatedSalary by Geography",
xlab = "Geography",
ylab = "EstimatedSalary",
)
boxplot(EstimatedSalary ~ Geography,
data = churn,
main = "Distribution of EstimatedSalary by Geography",
xlab = "Geography",
ylab = "EstimatedSalary",
border = "darkgrey"
)
num_gepgraphies <- length(levels(factor(geography_variable)))
box_colors <- c("lightblue", "lightgreen", "lightcoral")[1:num_gepgraphies]
boxplot(EstimatedSalary ~ Geography,
data = churn,
main = "Distribution of EstimatedSalary by Geography",
xlab = "Geography",
ylab = "EstimatedSalary",
col = box_colors[levels(factor(ethnicity_var))],
border = "darkgrey"
)
boxplot(EstimatedSalary ~ Geography,
data = churn,
main = "Distribution of EstimatedSalary by Geography",
xlab = "Geography",
ylab = "EstimatedSalary",
col = box_colors[levels(factor(geography_variable))],
border = "darkgrey"
)
mean_ordered <- mean_by_geography[levels(factor(geography_variable))]
points(1:num_gepgraphies, mean_ordered, col = "darkred", pch = 18, cex = 1.5)
churn
fuel
fuel
boxplot(CO2EMISSIONS ~ FUELTYPE, data = fuel)
knitr::opts_chunk$set(echo = TRUE)
library(e1071)
library(readr)
library(ggplot2)
library(dplyr)
scatter_plot_fueltype <- ggplot(data = fuel, aes(x = FUELCONSUMPTION_COMB_MPG, y = CO2EMISSIONS, color = FUELTYPE)) +
geom_point(alpha = 0.6) + # Use alpha for transparency to see overlapping points
labs(
title = "Relationship between CO2 Emissions and Fuel Consumption (MPG)",
subtitle = "Points colored by Fuel Type",
x = "Combined Fuel Consumption (MPG)",
y = "CO2 Emissions (g/km)",
color = "Fuel Type" # Legend title
) +
theme_minimal() + # Use a clean theme
theme(legend.position = "bottom")
d Fuel Consumption (MPG)",
ggplot(data = fuel, aes(x = FUELCONSUMPTION_COMB_MPG, y = CO2EMISSIONS, color = FUELTYPE)) +
geom_point(alpha = 0.6) + # Use alpha for transparency to see overlapping points
labs(
title = "Relationship between CO2 Emissions and Fuel Consumption (MPG)",
subtitle = "Points colored by Fuel Type",
x = "Combined Fuel Consumption (MPG)",
y = "CO2 Emissions (g/km)",
color = "Fuel Type" # Legend title
) +
theme_minimal() + # Use a clean theme
theme(legend.position = "bottom")
fuel
fuel_data_x <- fuel_data %>%
filter(FUELTYPE == "X")
fuel_data_x <- fuek %>%
filter(FUELTYPE == "X")
fuel_data_x <- fuel %>%
filter(FUELTYPE == "X")
ggplot(data = fuel, aes(x = fuel_data_x, y = CO2EMISSIONS, color = FUELTYPE)) +
geom_point(alpha = 0.6) + # Use alpha for transparency to see overlapping points
labs(
title = "Relationship between CO2 Emissions and Fuel Consumption (MPG)",
subtitle = "Points colored by Fuel Type",
x = "Combined Fuel Consumption (MPG)",
y = "CO2 Emissions (g/km)",
color = "Fuel Type" # Legend title
) +
theme_minimal() + # Use a clean theme
theme(legend.position = "bottom")
ggplot(data = fuel_data_x, aes(x = FUELCONSUMPTION_COMB_MPG, y = CO2EMISSIONS, color = FUELTYPE)) +
geom_point(alpha = 0.6) + # Use alpha for transparency to see overlapping points
labs(
title = "Relationship between CO2 Emissions and Fuel Consumption (MPG)",
subtitle = "Points colored by Fuel Type",
x = "Combined Fuel Consumption (MPG)",
y = "CO2 Emissions (g/km)",
color = "Fuel Type" # Legend title
) +
theme_minimal() + # Use a clean theme
theme(legend.position = "bottom")
ggplot(data = fuel_data_X, aes(x = log(FUELCONSUMPTION_COMB_MPG), y = log(CO2EMISSIONS))) +
geom_point(alpha = 0.6, color = "blue") + # Using a single color
geom_smooth(method = "lm", se = FALSE, color = "red", linetype = "dashed") + # Add linear regression line
labs(
title = "Log-Log Relationship between CO2 Emissions and Fuel Consumption (MPG)",
subtitle = "For Fuel Type 'X' (Regular Gasoline) Only",
x = "Log(Combined Fuel Consumption (MPG))",
y = "Log(CO2 Emissions (g/km))"
) +
theme_minimal()
ggplot(data = fuel_data_x, aes(x = log(FUELCONSUMPTION_COMB_MPG), y = log(CO2EMISSIONS))) +
geom_point(alpha = 0.6, color = "blue") + # Using a single color
geom_smooth(method = "lm", se = FALSE, color = "red", linetype = "dashed") + # Add linear regression line
labs(
title = "Log-Log Relationship between CO2 Emissions and Fuel Consumption (MPG)",
subtitle = "For Fuel Type 'X' (Regular Gasoline) Only",
x = "Log(Combined Fuel Consumption (MPG))",
y = "Log(CO2 Emissions (g/km))"
) +
theme_minimal()
log_log_model_x <- lm(log(CO2EMISSIONS) ~ log(FUELCONSUMPTION_COMB_MPG), data = fuel_data_x)
summary_log_log_model_x <- summary(log_log_model_x)
print(summary_log_log_model_x)
coefficients_x <- coef(log_log_model_x)
intercept_x <- coefficients_x[1]
slope_x <- coefficients_x[2]
cat("Linear Model Equation (Log-Log Scale) for Fuel Type 'X':\n")
cat(sprintf("log(CO2EMISSIONS) = %.4f + (%.4f) * log(FUELCONSUMPTION_COMB_MPG)\n", intercept_x, slope_x))
cat(sprintf("log(CO2EMISSIONS) = %.4f + (%.4f) * x\n", intercept_x, slope_x))
cat(sprintf("log(CO2EMISSIONS) = %.4f  %.4f * x\n", intercept_x, slope_x))
+
+
+
cat("Linear Model Equation (Log-Log Scale) for Fuel Type 'X':\n")
cat("Linear Model Equation (Log-Log Scale) for Fuel Type 'X':\n")
cat(sprintf("log(CO2EMISSIONS) = %.4f + (%.4f) * X\n", intercept_x, slope_x))
cat(sprintf("y = %.4f + (%.4f) * x\n", intercept_x, slope_x))
log_log_model_x <- lm(log(CO2EMISSIONS) ~ log(FUELCONSUMPTION_COMB_MPG), data = fuel_data_x)
summary_log_log_model_x <- summary(log_log_model_x)
print(summary_log_log_model_x)
coefficients_x <- coef(log_log_model_x)
intercept_x <- coefficients_x[1]
slope_x <- coefficients_x[2]
cat("Linear Model Equation (Log-Log Scale) for Fuel Type 'X':\n")
cat(sprintf("y = %.4f + (%.4f) * x\n", intercept_x, slope_x))
log_log_model_x <- lm(log(CO2EMISSIONS) ~ log(FUELCONSUMPTION_COMB_MPG), data = fuel_data_x)
summary_log_log_model_x <- summary(log_log_model_x)
print(summary_log_log_model_x)
coefficients_x <- coef(log_log_model_x)
coefficients_x <- coef(log_log_model_x)
intercept_x <- coefficients_x[1]
slope_x <- coefficients_x[2]
cat("Linear Model Equation (Log-Log Scale) for Fuel Type 'X':\n")
cat(sprintf("y = %.4f + (%.4f) * x\n", intercept_x, slope_x))
fuel
cat("Average Fuel Consumption and CO2 Emissions by Make:\n")
print(make_summary)
make_summary <- fuel %>%
group_by(MAKE) %>%
summarise(
avg_fuel_consumption_comb = mean(FUELCONSUMPTION_COMB, na.rm = TRUE),
avg_co2_emissions = mean(CO2EMISSIONS, na.rm = TRUE)
) %>%
ungroup()
cat("Average Fuel Consumption and CO2 Emissions by Make:\n")
print(make_summary)
library(readr)
library(dplyr)
library(plotly)
library(arules)
library(arulesViz)
df <- read_csv("Instacart.csv")
str(df)
View(df)
View(df)
df <- df[complete.cases(df), ] # Filtrar Ãºnicamente las filas que no tienen valores nulos.
View(df)
View(df)
n_distinct(df$id_orden)
transacciones <- plyr::ddply(df,c("id_orden"),
function(df1)paste(df1$producto,
collapse = ","))
View(transacciones)
View(transacciones)
head(transacciones)
transacciones$id_orden <- NULL
colnames(transacciones) <- c("items")
write.csv(transacciones,"itemsInsta.csv", quote = FALSE, row.names = FALSE)
tr <- read.transactions("itemsInsta.csv", format = 'basket', sep = ',')
summary(tr)
itemFrequencyPlot(tr, topN = 20, type = 'absolute')
reglas <- apriori(tr, parameter = list(supp=0.001,
conf=0.5,
maxlen=10))
summary(reglas)
reglas2 <- apriori(tr, parameter = list(supp=0.001,
conf=0.5,
maxlen=3))
summary(reglas)
summary(reglas2)
inspect(reglas[1:6])
inspect(reglas2[1:5])
quality(reglas)
quality(reglas2)
reglas_lift100 <- subset(reglas, lift >= 100)
inspect(reglas_lift100[1:3])
View(df)
View(df)
inspect(reglas_lift100[1:3])
inspect(reglas_lift100)
inspect(reglas_lift100[1:1])
inspect(reglas_lift100[1:2])
inspect(reglas_lift100[1:1])
inspect(reglas_lift100)
knitr::opts_chunk$set(echo = TRUE)
#install.packages("plyr")
#install.packages("arules")
#install.packages("arulesViz")
library(readr)
library(dplyr)
library(plotly)
library(arules)
library(arulesViz)
df <- read_csv("Instacart.csv")
View(df)
View(df)
str(df)
df <- df |>
mutate(producto = as.factor(producto)) |>
mutate(pasillo = as.factor(pasillo)) |>
mutate(departamento = as.factor(deparamento))
df <- df |>
mutate(producto = as.factor(producto)) |>
mutate(pasillo = as.factor(pasillo)) |>
mutate(departamento = as.factor(departamento))
str(df)
df <- df[complete.cases(df)]
df <- df[complete.cases(df), ]
df <- df |>
mutate(producto = as.factor(producto)) |>
mutate(pasillo = as.factor(pasillo)) |>
mutate(departamento = as.factor(departamento))
n_distinct(df$id_orden)
transacciones <- plyr::ddply(df, c("id_orden"), function(df1)paste(df1$producto, collapse = ","))
View(transacciones)
View(transacciones)
head(transacciones)
transacciones$id_orden <- NULL
colnames(transacciones) <- c("items")
View(transacciones)
View(transacciones)
write.csv(transacciones,"itemsInstacart.csv", quote = FALSE, row.names = FALSE)
tr <- read.transactions("itemsInstacart.csv", format = 'basket', sep = ',')
summary(tr)
itemFrequencyPlot(tr, topN = 20, type = 'absolute')
reglas <- apriori(tr, parameter = list(supp=0.001, conf=0.8, maxlen=10))
summary(reglas)
View(reglas)
View(reglas)
View(reglas)
reglas <- apriori(tr, parameter = list(supp=0.001, conf=0.5, maxlen=10))
summary(reglas)
inspect(reglas)
quality(reglas)
reglas <- apriori(tr, parameter = list(supp=0.001, conf=0.3, maxlen=10))
summary(reglas)
inspect(reglas)
quality(reglas)
reglas_lift100 <- subset(reglas, lift >= 100)
View(reglas_lift100)
View(reglas_lift100)
inspect(reglas)
rules_pairs <- subset(rules, subset = length(lhs) == 1 & length(rhs) == 1)
pairs_idx    <- size(lhs(rules)) == 1 & size(rhs(rules)) == 1
# 13, 14, 52
inspect(reglas[13])
inspect(reglas[14])
inspect(reglas[52])
reglas_portavelas <- apriori(tr, parameter = list(supp = 0.001, conf = 0.8, maxlen = 5),
appearance = list(default = 'lhs', rhs = "Banana"))
reglas_banana <- apriori(tr, parameter = list(supp = 0.001, conf = 0.8, maxlen = 5),
appearance = list(default = 'lhs', rhs = "Banana"))
inspect(reglas_banana)
inspect(reglas_banana)
reglas_banana <- apriori(tr, parameter = list(supp = 0.001, conf = 0.8, maxlen = 5),
appearance = list(default = 'lhs', rhs = "Banana"))
inspect(reglas_banana)
reglas_banana <- apriori(tr, parameter = list(supp = 0.001, conf = 0.3, maxlen = 5),
appearance = list(default = 'lhs', rhs = "Banana"))
inspect(reglas_banana)
plot(reglas_banana)
plot(reglas_banana, engine = 'plotly')
plot(reglas_banana, method = "graph",  engine = "htmlwidget")
plot(reglas, method = "graph",  engine = "htmlwidget")
plot(reglas, method = "graph",  engine = "htmlwidget")
View(df)
View(df)
View(tr)
View(tr)
View(df)
View(df)
# 13, 14, 52
inspect(reglas[13])
inspect(reglas[14])
inspect(reglas[52])
View(df)
View(df)
knitr::opts_chunk$set(echo = TRUE)
#install.packages("plyr")
#install.packages("arules")
#install.packages("arulesViz")
library(readr)
library(dplyr)
library(plotly)
library(arules)
library(arulesViz)
df <- read_csv("Instacart.csv")
str(df)
df <- df[complete.cases(df), ]
df <- df |>
mutate(producto = as.factor(producto)) |>
mutate(pasillo = as.factor(pasillo)) |>
mutate(departamento = as.factor(departamento))
n_distinct(df$id_orden)
transacciones <- plyr::ddply(df, c("id_orden"), function(df1)paste(df1$producto, collapse = ","))
head(transacciones)
transacciones$id_orden <- NULL
colnames(transacciones) <- c("items")
write.csv(transacciones,"itemsInstacart.csv", quote = FALSE, row.names = FALSE)
tr <- read.transactions("itemsInstacart.csv", format = 'basket', sep = ',')
summary(tr)
itemFrequencyPlot(tr, topN = 20, type = 'absolute')
reglas <- apriori(tr, parameter = list(supp=0.001, conf=0.3, maxlen=10))
summary(reglas)
inspect(reglas)
reglas_lift100 <- subset(reglas, lift >= 100)
inspect(reglas)
# 13, 14, 52
inspect(reglas[13])
inspect(reglas[14])
inspect(reglas[52])
plot(reglas)
plot(reglas, engine = 'plotly')
plot(reglas, engine = 'plotly')
plot(reglas, method = "graph",  engine = "htmlwidget")
inspect(reglas[13])
inspect(reglas[14])
inspect(reglas[52])
inspect(reglas[13])
inspect(reglas[14])
inspect(reglas[52])
inspect(reglas[189])
inspect(reglas[13])
inspect(reglas[14])
inspect(reglas[52])
inspect(reglas[189])
tinytex::tlmgr_install(c("babel-spanish", "enumitem", "hyperref", "geometry", "xcolor", "titlesec", "fancyhdr"))
knitr::opts_chunk$set(echo = TRUE)
library(nortest)
churn <- read.csv("Churn_Modelling.csv")
cuant_discretas <- c(
"CreditScore",
"Tenure",
"NumOfProducts"
)
cuant_continuas <- c(
"Age",
"Balance"
"EstimatedSalary"
cuant_continuas <- c(
"Age",
"Balance"';
"EstimatedSalary"
)
cuant_discretas <- c(
"CreditScore",
"Tenure",
"NumOfProducts"
)
cuant_continuas <- c(
"Age",
"Balance"';
cuant_continuas <- c(
"Age",
"Balance";
cuant_continuas <- c(
"Age";
View(df)
knitr::opts_chunk$set(echo = TRUE)
data(iris)
df <- iris
View(df)
View(df)
dist_matrix <- dist(df_scaled)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(cluster)
library(factoextra)
library(GGally)
data(iris)
df <- iris
head(df)
str(df)
summary(df)
GGally::ggpairs(df, columns = 1:4, aes(color = Species))
df_num <- df %>% select(-Species)
df_scaled <- scale(df_num)
fviz_nbclust(df_scaled, kmeans, method = "wss")
fviz_nbclust(df_scaled, kmeans, method = "silhouette")
set.seed(123)
kmeans_model <- kmeans(df_scaled, centers = 3, nstart = 25)
str(kmeans_model)
fviz_cluster(kmeans_model, data = df_scaled,
geom = "point",
ellipse.type = "convex",
ggtheme = theme_minimal())
sil <- silhouette(kmeans_model$cluster, dist(df_scaled))
summary(sil)
fviz_silhouette(sil)
cluster_vs_species <- table(Cluster = kmeans_model$cluster, Species = df$Species)
cluster_vs_species
dist_matrix <- dist(df_scaled)
hc <- hclust(dist_matrix, method = "ward.D2")
plot(hc, labels = FALSE, hang = -1)
rect.hclust(hc, k = 3, border = 2:4)
setwd("~/code/data/03-clustering")
library(tidyverse)
library(cluster)
library(factoextra)
library(GGally)
data(iris)
df <- iris
head(df)
str(df)
summary(df)
GGally::ggpairs(df, columns = 1:4, aes(color = Species))
df_num <- df %>% select(-Species)
df_scaled <- scale(df_num)
View(df_num)
View(df_num)
View(df_scaled)
View(df_scaled)
fviz_nbclust(df_scaled, kmeans, method = "wss")
fviz_nbclust(df_scaled, kmeans, method = "silhouette")
set.seed(123)
kmeans_model <- kmeans(df_scaled, centers = 3, nstart = 25)
str(kmeans_model)
fviz_cluster(kmeans_model, data = df_scaled,
geom = "point",
ellipse.type = "convex",
ggtheme = theme_minimal())
sil <- silhouette(kmeans_model$cluster, dist(df_scaled))
summary(sil)
fviz_silhouette(sil)
cluster_vs_species <- table(Cluster = kmeans_model$cluster, Species = df$Species)
cluster_vs_species
dist_matrix <- dist(df_scaled)
hc <- hclust(dist_matrix, method = "ward.D2")
plot(hc, labels = FALSE, hang = -1)
rect.hclust(hc, k = 3, border = 2:4)
set.seed(123)
kmeans_model <- kmeans(df_scaled, centers = 5, nstart = 25)
str(kmeans_model)
fviz_cluster(kmeans_model, data = df_scaled,
geom = "point",
ellipse.type = "convex",
ggtheme = theme_minimal())
sil <- silhouette(kmeans_model$cluster, dist(df_scaled))
summary(sil)
fviz_silhouette(sil)
cluster_vs_species <- table(Cluster = kmeans_model$cluster, Species = df$Species)
cluster_vs_species
set.seed(123)
kmeans_model <- kmeans(df_scaled, centers = 150, nstart = 25)
set.seed(123)
kmeans_model <- kmeans(df_scaled, centers = 75, nstart = 25)
str(kmeans_model)
fviz_cluster(kmeans_model, data = df_scaled,
geom = "point",
ellipse.type = "convex",
ggtheme = theme_minimal())
sil <- silhouette(kmeans_model$cluster, dist(df_scaled))
summary(sil)
set.seed(123)
kmeans_model <- kmeans(df_scaled, centers = 2, nstart = 25)
str(kmeans_model)
fviz_cluster(kmeans_model, data = df_scaled,
geom = "point",
ellipse.type = "convex",
ggtheme = theme_minimal())
sil <- silhouette(kmeans_model$cluster, dist(df_scaled))
summary(sil)
set.seed(123)
kmeans_model <- kmeans(df_scaled, centers = 1, nstart = 25)
set.seed(123)
kmeans_model <- kmeans(df_scaled, centers = 1, nstart = 25)
str(kmeans_model)
fviz_cluster(kmeans_model, data = df_scaled,
geom = "point",
ellipse.type = "convex",
ggtheme = theme_minimal())
sil <- silhouette(kmeans_model$cluster, dist(df_scaled))
summary(sil)
sil <- silhouette(kmeans_model$cluster, dist(df_scaled))
summary(sil)
